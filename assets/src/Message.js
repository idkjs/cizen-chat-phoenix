// Generated by BUCKLESCRIPT VERSION 4.0.7, PLEASE EDIT WITH CARE
'use strict';

var $$Array = require("bs-platform/lib/js/array.js");
var Curry = require("bs-platform/lib/js/curry.js");
var MessageMap$CizenChat = require("./MessageMap.js");
var Caml_builtin_exceptions = require("bs-platform/lib/js/caml_builtin_exceptions.js");

function addMsg(avatar_id, room, body, map) {
  var msg = /* record */[
    /* body */body,
    /* avatar_id */avatar_id
  ];
  if (Curry._2(MessageMap$CizenChat.MessageMap[/* mem */2], room, map)) {
    var messages = Curry._2(MessageMap$CizenChat.MessageMap[/* find */21], room, map);
    return Curry._3(MessageMap$CizenChat.MessageMap[/* add */3], room, $$Array.concat(/* :: */[
                    messages,
                    /* :: */[
                      /* array */[msg],
                      /* [] */0
                    ]
                  ]), map);
  } else {
    return Curry._3(MessageMap$CizenChat.MessageMap[/* add */3], room, /* array */[msg], map);
  }
}

function getMsg(room, map) {
  try {
    return Curry._2(MessageMap$CizenChat.MessageMap[/* find */21], room, map);
  }
  catch (exn){
    if (exn === Caml_builtin_exceptions.not_found) {
      return /* array */[];
    } else {
      throw exn;
    }
  }
}

exports.addMsg = addMsg;
exports.getMsg = getMsg;
/* MessageMap-CizenChat Not a pure module */
